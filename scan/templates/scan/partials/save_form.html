<div class="bg-green-50 border-2 border-green-300 rounded-xl p-6">
    <h2 class="text-2xl font-bold text-green-800 mb-4">âœ“ Text Extracted!</h2>
    
    <!-- Stats -->
    <div class="bg-white rounded-lg p-4 mb-4">
        <p class="text-gray-700"><strong>Pages:</strong> {{ page_count }}</p>
        <p class="text-gray-700"><strong>Characters:</strong> {{ extracted_text|length }}</p>
    </div>
    
    <!-- Preview Text -->
    <details class="bg-white rounded-lg p-4 mb-6">
        <summary class="font-bold text-blue-600 cursor-pointer">ðŸ“„ View Extracted Text</summary>
        <pre class="mt-3 p-3 bg-gray-50 rounded text-xs whitespace-pre-wrap max-h-64 overflow-y-auto">{{ extracted_text }}</pre>
    </details>
    
    <!-- Save Form -->
    <form method="POST" action="{% url 'save_topic' %}" class="space-y-4">
        {% csrf_token %}
        
        <h3 class="text-xl font-bold text-indigo-600 mb-4">ðŸ“š Save as Topic</h3>
        
        <!-- Course Selection -->
        <div>
            <label class="block font-semibold mb-2">Course</label>
            <div class="space-y-2">
                <label class="flex items-center gap-2">
                    <input type="radio" name="course_option" value="existing" checked onchange="toggleCourseFields()">
                    <span>Use existing course</span>
                </label>
                <select name="existing_course" id="existingCourse" class="w-full p-3 border-2 rounded-lg">
                    <option value="">-- Select Course --</option>
                    {% for course in courses %}
                    <option value="{{ course.id }}">{{ course.name }}</option>
                    {% endfor %}
                </select>
                
                <label class="flex items-center gap-2 mt-3">
                    <input type="radio" name="course_option" value="new" onchange="toggleCourseFields()">
                    <span>Create new course</span>
                </label>
                <div id="newCourseFields" class="hidden space-y-2 pl-6">
                    <input type="text" name="new_course_name" placeholder="Course Name (e.g., BIO 202)" class="w-full p-3 border-2 rounded-lg">
                    <input type="text" name="new_course_subject" placeholder="Subject (optional)" class="w-full p-3 border-2 rounded-lg">
                </div>
            </div>
        </div>
        
        <!-- Topic Title -->
        <div>
            <label class="block font-semibold mb-2">Topic Title *</label>
            <input type="text" name="topic_title" required placeholder="e.g., Cell Division" class="w-full p-3 border-2 rounded-lg">
        </div>
        
        <!-- Page Range -->
        <div>
            <label class="block font-semibold mb-2">Page Range (optional)</label>
            <input type="text" name="page_range" placeholder="e.g., Pages 5-8" class="w-full p-3 border-2 rounded-lg">
        </div>
        
        <!-- Submit -->
        <div class="flex gap-3">
            <button type="submit" class="flex-1 bg-green-600 hover:bg-green-700 text-white font-bold py-4 px-6 rounded-lg">
                ðŸ’¾ Save Topic
            </button>
            <a href="{% url 'scan_new' %}" class="flex-1 bg-gray-600 hover:bg-gray-700 text-white font-bold py-4 px-6 rounded-lg text-center">
                Cancel
            </a>
        </div>
    </form>
</div>

<script>
function toggleCourseFields() {
    const option = document.querySelector('input[name="course_option"]:checked').value;
    document.getElementById('existingCourse').disabled = option === 'new';
    document.getElementById('newCourseFields').classList.toggle('hidden', option === 'existing');
}
</script>